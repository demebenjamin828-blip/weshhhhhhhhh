<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Quiz Nouveau Testament üìñ</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background: #eef2f7; padding: 20px; display: flex; justify-content: center; }
        .quiz-container { background: white; padding: 30px; border-radius: 15px; box-shadow: 0 4px 20px rgba(0,0,0,0.1); width: 100%; max-width: 600px; }
        h2 { color: #2c3e50; text-align: center; border-bottom: 3px solid #3ecf8e; padding-bottom: 10px; }
        .question-block { margin-bottom: 15px; padding: 10px; border-radius: 8px; }
        label { display: block; font-weight: bold; margin-bottom: 5px; color: #34495e; }
        input { width: 100%; padding: 10px; border: 1px solid #dcdfe6; border-radius: 8px; box-sizing: border-box; }
        button { width: 100%; padding: 15px; background: #3ecf8e; color: white; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; font-size: 16px; margin-top: 20px; }
        
        /* Styles pour les r√©sultats */
        #resultats { display: none; margin-top: 20px; }
        .score-box { text-align: center; font-size: 24px; font-weight: bold; padding: 20px; border-radius: 10px; margin-bottom: 20px; }
        .correct { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; padding: 10px; border-radius: 5px; margin-top: 5px; }
        .wrong { background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; padding: 10px; border-radius: 5px; margin-top: 5px; }
    </style>
</head>
<body>

<div class="quiz-container">
    <h2>Quiz : Le Nouveau Testament üïäÔ∏è</h2>
    
    <form id="bibleQuiz">
        <div class="question-block">
            <label>Ton pr√©nom :</label>
            <input type="text" id="nom" required>
        </div>

        <div class="question-block"><label>1. Dans quelle ville J√©sus est-il n√© ?</label><input type="text" id="q1" required></div>
        <div class="question-block"><label>2. Quel ap√¥tre a reni√© J√©sus trois fois ?</label><input type="text" id="q2" required></div>
        <div class="question-block"><label>3. Quel est le dernier livre de la Bible ?</label><input type="text" id="q3" required></div>
        <div class="question-block"><label>4. Qui a baptis√© J√©sus ?</label><input type="text" id="q4" required></div>
        <div class="question-block"><label>5. Combien y a-t-il d'√âvangiles ? (en chiffres)</label><input type="text" id="q5" required></div>
        <div class="question-block"><label>6. Sur quelle mer J√©sus a-t-il march√© ?</label><input type="text" id="q6" required></div>
        <div class="question-block"><label>7. Qui a √©crit la majorit√© des √âp√Ætres ?</label><input type="text" id="q7" required></div>
        <div class="question-block"><label>8. Quel miracle a eu lieu aux noces de Cana ? (L'eau en...)</label><input type="text" id="q8" required></div>
        <div class="question-block"><label>9. Quel ap√¥tre √©tait collecteur d'imp√¥ts ?</label><input type="text" id="q9" required></div>
        <div class="question-block"><label>10. Qui a trahi J√©sus ?</label><input type="text" id="q10" required></div>

        <button type="submit" id="submitBtn">Voir mon score</button>
    </form>

    <div id="resultats">
        <div id="scoreDisplay" class="score-box"></div>
        <div id="correctionList"></div>
        <button onclick="window.location.reload()">Recommencer</button>
    </div>
</div>

<script>
    const _supabase = supabase.createClient('https://inrcrtyvbgjrrccpzxlk.supabase.co', 'sb_publishable_tEVOnHljw_fz5UC_cEG9pA_9xglC1VK');

    // LA CL√â DE CORRECTION (On met plusieurs options si besoin)
    const reponsesCorrectes = {
        q1: ["bethl√©em", "bethleem"],
        q2: ["pierre", "saint pierre"],
        q3: ["apocalypse"],
        q4: ["jean le baptiste", "jean baptiste"],
        q5: ["4"],
        q6: ["galil√©e", "galilee", "tib√©riade", "tiberiade"],
        q7: ["paul", "saint paul"],
        q8: ["vin"],
        q9: ["matthieu"],
        q10: ["judas", "judas iscariote"]
    };

    document.getElementById('bibleQuiz').addEventListener('submit', async (e) => {
        e.preventDefault();
        const btn = document.getElementById('submitBtn');
        btn.disabled = true;

        const userAnswers = {
            nom: document.getElementById('nom').value,
            q1: document.getElementById('q1').value.toLowerCase().trim(),
            q2: document.getElementById('q2').value.toLowerCase().trim(),
            q3: document.getElementById('q3').value.toLowerCase().trim(),
            q4: document.getElementById('q4').value.toLowerCase().trim(),
            q5: document.getElementById('q5').value.toLowerCase().trim(),
            q6: document.getElementById('q6').value.toLowerCase().trim(),
            q7: document.getElementById('q7').value.toLowerCase().trim(),
            q8: document.getElementById('q8').value.toLowerCase().trim(),
            q9: document.getElementById('q9').value.toLowerCase().trim(),
            q10: document.getElementById('q10').value.toLowerCase().trim()
        };

        // CALCUL DU SCORE
        let score = 0;
        let htmlCorrection = "<h3>D√©tails :</h3>";

        for (let i = 1; i <= 10; i++) {
            const field = "q" + i;
            const isCorrect = reponsesCorrectes[field].includes(userAnswers[field]);
            
            if (isCorrect) {
                score++;
                htmlCorrection += `<div class="correct">‚úÖ Question ${i} : Bravo !</div>`;
            } else {
                htmlCorrection += `<div class="wrong">‚ùå Question ${i} : La bonne r√©ponse √©tait <b>${reponsesCorrectes[field][0]}</b></div>`;
            }
        }

        // ENVOI √Ä SUPABASE (On garde une trace)
        await _supabase.from('reponses').insert([{
            nom_ami: userAnswers.nom,
            reponse_1: userAnswers.q1, reponse_2: userAnswers.q2, reponse_3: userAnswers.q3,
            reponse_4: userAnswers.q4, reponse_5: userAnswers.q5, reponse_6: userAnswers.q6,
            reponse_7: userAnswers.q7, reponse_8: userAnswers.q8, reponse_9: userAnswers.q9,
            reponse_10: userAnswers.q10
        }]);

        // AFFICHAGE FINAL
        document.getElementById('bibleQuiz').style.display = 'none';
        document.getElementById('resultats').style.display = 'block';
        
        const scoreDiv = document.getElementById('scoreDisplay');
        scoreDiv.innerHTML = `Ton score : ${score} / 10`;
        scoreDiv.style.background = score >= 5 ? "#d4edda" : "#f8d7da";
        
        document.getElementById('correctionList').innerHTML = htmlCorrection;
    });
</script>

</body>
</html>
