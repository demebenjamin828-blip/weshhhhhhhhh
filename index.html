<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Examen Nouveau Testament üìñ</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        :root { 
            --success: #27ae60; --error: #e74c3c; --primary: #2c3e50; 
            --gold: #d4af37; --light: #f8f9fa; 
        }

        /* Animation d'entr√©e */
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Animation d'erreur (tremblement) */
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            background: linear-gradient(135deg, #e0eafc 0%, #cfdef3 100%);
            display: flex; justify-content: center; padding: 20px; min-height: 100vh;
        }

        .quiz-card { 
            background: white; padding: 40px; border-radius: 20px; 
            box-shadow: 0 15px 35px rgba(0,0,0,0.1); width: 100%; max-width: 700px;
            animation: fadeInUp 0.8s ease-out;
        }

        h2 { text-align: center; color: var(--primary); font-size: 28px; margin-bottom: 10px; }
        .divider { height: 4px; width: 60px; background: var(--gold); margin: 0 auto 30px; border-radius: 2px; }

        .info-section { 
            display: grid; grid-template-columns: 1fr 1fr; gap: 15px; 
            margin-bottom: 30px; padding: 20px; background: var(--light); 
            border-radius: 12px; border-left: 5px solid var(--primary);
        }

        .q-block { 
            margin-bottom: 20px; padding: 20px; border-radius: 12px; 
            border: 1px solid #eee; transition: all 0.3s ease;
            background: #fff;
        }

        .q-block:hover { box-shadow: 0 5px 15px rgba(0,0,0,0.05); border-color: var(--gold); }

        label { display: block; font-weight: 600; margin-bottom: 12px; color: var(--primary); }

        input { 
            width: 100%; padding: 12px 15px; border: 2px solid #ddd; 
            border-radius: 8px; transition: all 0.3s ease; outline: none;
        }

        input:focus { border-color: var(--primary); box-shadow: 0 0 8px rgba(44, 62, 80, 0.2); }

        /* Correction */
        .is-correct { border-color: var(--success) !important; background: #f0fff4; }
        .is-wrong { border-color: var(--error) !important; background: #fff5f5; animation: shake 0.4s; }

        .feedback { display: none; font-size: 14px; margin-top: 10px; font-weight: bold; color: var(--error); }

        .btn-main { 
            width: 100%; padding: 18px; background: var(--primary); color: white; 
            border: none; border-radius: 10px; cursor: pointer; font-size: 18px; 
            font-weight: bold; transition: transform 0.2s, background 0.3s;
        }

        .btn-main:hover { background: #1a252f; transform: translateY(-2px); }
        .btn-main:active { transform: translateY(0); }

        #res-summary { 
            display: none; text-align: center; padding: 25px; border-radius: 15px; 
            margin-bottom: 30px; font-size: 26px; font-weight: bold;
            animation: fadeInUp 0.5s both;
        }
    </style>
</head>
<body>

<div class="quiz-card">
    <h2>Examen du Nouveau Testament</h2>
    <div class="divider"></div>
    
    <div id="res-summary"></div>

    <form id="quizForm">
        <div class="info-section">
            <input type="text" id="prenom" placeholder="Pr√©nom" required>
            <input type="text" id="nom" placeholder="Nom" required>
            <input type="email" id="email" placeholder="Email" style="grid-column: span 2;" required>
        </div>

        <div class="q-block" id="block1">
            <label>1. Dans quelle ville J√©sus est-il n√© ?</label>
            <input type="text" id="q1" required>
            <div class="feedback" id="f1"></div>
        </div>

        <div class="q-block" id="block2">
            <label>2. Quel ap√¥tre a reni√© J√©sus trois fois ?</label>
            <input type="text" id="q2" required>
            <div class="feedback" id="f2"></div>
        </div>

        <button type="submit" id="btnEnvoyer" class="btn-main">Soumettre l'Examen</button>
    </form>
    
    <button onclick="location.reload()" id="btnReset" class="btn-main" style="display:none; background:#7f8c8d; margin-top:10px;">Refaire un essai</button>
</div>

<script>
    const _supabase = supabase.createClient('https://inrcrtyvbgjrrccpzxlk.supabase.co', 'sb_publishable_tEVOnHljw_fz5UC_cEG9pA_9xglC1VK');

    const ANSWERS = {
        q1: ["bethl√©em", "bethleem"],
        q2: ["pierre", "saint pierre"]
    };

    document.getElementById('quizForm').addEventListener('submit', async (e) => {
        e.preventDefault();
        
        const btn = document.getElementById('btnEnvoyer');
        btn.disabled = true;
        btn.innerText = "Analyse des r√©ponses...";

        let score = 0;
        const total = 2; // Mets 10 ici quand tu auras ajout√© toutes les questions

        for (let i = 1; i <= total; i++) {
            const input = document.getElementById('q' + i);
            const block = document.getElementById('block' + i);
            const feedback = document.getElementById('f' + i);
            const val = input.value.toLowerCase().trim();

            if (ANSWERS['q'+i].includes(val)) {
                score++;
                block.classList.add('is-correct');
            } else {
                block.classList.add('is-wrong');
                feedback.style.display = "block";
                feedback.innerHTML = "üí° La r√©ponse √©tait : " + ANSWERS['q'+i][0].toUpperCase();
            }
            input.disabled = true;
        }

        // Envoi Supabase
        await _supabase.from('reponses').insert([{
            prenom: document.getElementById('prenom').value,
            nom: document.getElementById('nom').value,
            email: document.getElementById('email').value,
            reponse_1: document.getElementById('q1').value,
            reponse_2: document.getElementById('q2').value
        }]);

        // R√©sultat final anim√©
        const resDiv = document.getElementById('res-summary');
        resDiv.style.display = "block";
        resDiv.innerHTML = `SCORE FINAL : ${score} / ${total}`;
        resDiv.style.background = score >= (total/2) ? "#d4edda" : "#f8d7da";
        resDiv.style.color = score >= (total/2) ? "#155724" : "#721c24";
        
        btn.style.display = "none";
        document.getElementById('btnReset').style.display = "block";
    });
</script>

</body>
</html>
